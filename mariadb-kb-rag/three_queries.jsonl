{"query": "SELECT inventory_in_stock(10);\nINSERT INTO rental(rental_date, inventory_id, customer_id, staff_id) VALUES(NOW(), 10, 3, 1);\nSET @rentID = LAST_INSERT_ID(), @balance = get_customer_balance(3, NOW());\nSELECT @rentID, @balance;\nINSERT INTO payment (customer_id, staff_id, rental_id, amount,  payment_date) VALUES(3, 1, @rentID, @balance, NOW());", "description": "To rent a DVD, first confirm that the given inventory item is in stock, and then insert a row into the rental table. After the rental table is created, insert a row into the payment table. Depending on business rules, you may also need to check whether the customer has an outstanding balance before processing the rental."}
{"query": "SELECT rental_id FROM rental WHERE inventory_id = 10 AND customer_id = 3 AND return_date IS NULL INTO @rentID;\nSELECT @rentID;\nUPDATE rental SET return_date = NOW() WHERE rental_id = @rentID;\nSELECT get_customer_balance(3, NOW());", "description": "To return a DVD, update the rental table and set the return date. To do this, first identify the rental_id to update based on the inventory_id of the item being returned. Depending on the situation, it may be necessary to check the customer balance and perhaps process a payment for overdue fees by inserting a row into the payment table."}
{"query": "SELECT CONCAT(customer.last_name, ', ', customer.first_name) AS customer, address.phone, film.title FROM rental INNER JOIN customer ON rental.customer_id = customer.customer_id INNER JOIN address ON customer.address_id = address.address_id INNER JOIN inventory ON rental.inventory_id = inventory.inventory_id INNER JOIN film ON inventory.film_id = film.film_id WHERE rental.return_date IS NULL AND rental_date + INTERVAL film.rental_duration DAY < CURRENT_DATE() ORDER BY title LIMIT 5;", "description": "Many DVD stores produce a daily list of overdue rentals so that customers can be contacted and asked to return their overdue DVDs. To create such a list, search the rental table for films with a return date that is NULL and where the rental date is further in the past than the rental duration specified in the film table. If so, the film is overdue and we should produce the name of the film along with the customer name and phone number."}
